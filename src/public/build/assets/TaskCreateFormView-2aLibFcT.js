import{r as _,G as C,C as h,u as T,o as D,a as y,w as l,_ as B,h as v,b as d,d as o,e as E,g as N,i as x,H as U,v as F,K as q,E as f,I as k,N as A,n as g,s as r,x as c,f as I,F as M,y as j,z as i,k as O,j as z,l as G}from"./main-sBzAe846.js";import"./vue-multiselect.esm-FWVWC-0N.js";const H={class:"overflow-x-auto"},K={class:"w-full whitespace-nowrap"},L={class:"border-t px-6 py-4"},P={class:"border-t px-6 py-4"},J={class:"border-t px-6 py-4"},Q={class:"border-t px-6 py-4"},R={class:"border-t px-6 py-4"},W={class:"border-t px-6 py-4"},X={key:1,class:"text-green-500 font-medium"},Y={key:0},ae={__name:"TaskCreateFormView",setup(Z){const u=_([]),n=_([]),s=C({date:new Date().toISOString().split("T")[0],courier:null,orders:[],selectedOrders:new Set}),p=_(""),b=()=>(p.value=s.date?"":"Date is required",!p.value),S=()=>{b()&&v.post("/api/task",{date:s.date,courierUuid:s.courier?.id||null,orderUuids:Array.from(s.selectedOrders).map(t=>t.label)}).then(t=>{G.push({path:"tasks"})}).catch(t=>{console.error("Error creating task:",t)})};h(()=>s.date,t=>{t&&m()});const $=T();h($.orders,t=>{m()});const m=()=>{v.get(`/api/task-form/${s.date}`).then(t=>{u.value=t.data.data.couriers.map(e=>({id:e.uuid,label:e.name})),n.value=t.data.data.orders.map(e=>({id:e.id,label:e.uuid,time:`${e.from} - ${e.to}`,pickup:e.start_point.address||"-",delivery:e.end_point.address||"-",unitType:e.unit_type||"-"})),s.courier=u.value[0]||null,s.selectedOrders.clear()}).catch(t=>{console.error("Error fetching tasks:",t)})},w=t=>s.selectedOrders.has(t.id),V=t=>{s.selectedOrders.has(t.id)?s.selectedOrders.delete(t.id):s.selectedOrders.add(t.id),s.orders=Array.from(s.selectedOrders).map(e=>n.value.find(a=>a.id===e))};return D(()=>{m()}),(t,e)=>(d(),y(B,null,{default:l(()=>[o(E,null,{default:l(()=>[o(N,{icon:x(U),title:"Create task",main:""},null,8,["icon"]),o(F,{form:"",onSubmit:q(S,["prevent"]),"is-form":!0},{footer:l(()=>[o(z,null,{default:l(()=>[o(O,{type:"submit",color:"info",label:"Submit"})]),_:1})]),default:l(()=>[o(f,{label:"Date",error:p.value,required:""},{default:l(()=>[o(k,{modelValue:s.date,"onUpdate:modelValue":[e[0]||(e[0]=a=>s.date=a),b],type:"date",icon:x(A),required:""},null,8,["modelValue","icon"])]),_:1},8,["error"]),o(g),o(f,{label:"Couriers"},{default:l(()=>[o(k,{modelValue:s.courier,"onUpdate:modelValue":e[1]||(e[1]=a=>s.courier=a),options:u.value,"option-label":a=>a.label,"option-value":a=>a.id},null,8,["modelValue","options","option-label","option-value"])]),_:1}),o(f,{label:"Orders"},{default:l(()=>[r("div",H,[r("table",K,[e[3]||(e[3]=r("thead",null,[r("tr",{class:"text-left font-bold"},[r("th",{class:"px-6 pt-6 pb-4"},"ID"),r("th",{class:"px-6 pt-6 pb-4"},"Time"),r("th",{class:"px-6 pt-6 pb-4"},"Pickup"),r("th",{class:"px-6 pt-6 pb-4"},"Delivery"),r("th",{class:"px-6 pt-6 pb-4"},"Unit Type"),r("th",{class:"px-6 pt-6 pb-4"},"Action")])],-1)),r("tbody",null,[(d(!0),c(M,null,j(n.value,a=>(d(),c("tr",{key:a.id,class:"hover:bg-gray-100 focus-within:bg-gray-100"},[r("td",L,i(a.id),1),r("td",P,i(a.time),1),r("td",J,i(a.pickup),1),r("td",Q,i(a.delivery),1),r("td",R,i(a.unitType),1),r("td",W,[w(a)?(d(),c("span",X," Selected ")):(d(),y(O,{key:0,type:"button",color:"info",label:"Select",small:"",onClick:ee=>V(a)},null,8,["onClick"]))])]))),128)),n.value.length?I("",!0):(d(),c("tr",Y,[...e[2]||(e[2]=[r("td",{colspan:"5",class:"px-6 py-4 text-center text-gray-500"}," No orders available for the selected date ",-1)])]))])])])]),_:1}),o(g)]),_:1})]),_:1})]),_:1}))}};export{ae as default};
